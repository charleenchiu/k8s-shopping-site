在專案的開發環境中，使用虛擬環境（例如 `venv`）來管理依賴套件可以保持專案依賴的獨立性。以下是如何在專案的 `src/user-service/` 資料夾下使用 `venv` 設定 Python 開發環境並建置一個簡單的 `index.py` 檔案來測試。

### 1. 建立虛擬環境

首先，進入 `src/user-service/` 資料夾，並在該目錄中創建虛擬環境。

```bash
cd src/user-service
python -m venv venv  # 建立虛擬環境
```

### 2. 啟動虛擬環境

在不同作業系統中，啟動 `venv` 虛擬環境的指令會有所不同：

- **Windows**:
  ```bash
  .\venv\Scripts\activate
  ```

- **macOS / Linux**:
  ```bash
  source venv/bin/activate
  ```

啟動成功後，您會在終端機提示符前看到 `(venv)`，表示已經在虛擬環境內。

### 3. 安裝專案依賴

在虛擬環境中，安裝 FastAPI、pymongo 和 Uvicorn 等依賴套件，以便建立和執行 API 服務：

```bash
pip install fastapi pymongo uvicorn
```

這些安裝的套件會儲存在 `venv` 環境中，不會影響到系統的其他 Python 安裝。

### 4. 建立 `index.py` 作為 FastAPI 入口

在 `src/user-service/` 目錄下，創建一個 `index.py` 檔案，作為此微服務的 API 入口。

```python
# src/user-service/index.py

from fastapi import FastAPI
from pymongo import MongoClient

app = FastAPI()

# 連接到本地端 MongoDB (Docker 版本)
client = MongoClient("mongodb://localhost:27017/")
db = client["user_db"]

@app.get("/")
async def read_root():
    return {"message": "Welcome to the User Service API"}

@app.get("/users")
async def get_users():
    # 查詢所有用戶（範例）資料
    users = list(db["users"].find({}, {"_id": 0}))  # 假設有 "users" 集合
    return {"users": users}
```

### 5. 執行 API 服務

使用 Uvicorn 來啟動 API，驗證 `index.py` 是否可以正確執行：

```bash
uvicorn index:app --host 0.0.0.0 --port 8001 --reload
```

這樣會在 `http://localhost:8001` 啟動一個簡單的 API 服務，您可以訪問 `http://localhost:8001/users` 來測試連線到 MongoDB 並取得用戶資料。

### 6. 驗證和測試 API

在啟動的服務中測試您的 API，例如使用瀏覽器或 [Postman](https://www.postman.com/) 發送 `GET` 請求到：

- `http://localhost:8001/` ：會顯示根目錄訊息
- `http://localhost:8001/users` ：會顯示 MongoDB 中的所有用戶資料

這樣您便能在 `venv` 環境下開發、測試和執行該微服務。