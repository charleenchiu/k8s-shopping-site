# 功能說明書：Payment Service
`payment-service` 相關檔案的功能說明書，分別針對 `app.py`、`PaymentCRUDPage.py`、`test_payment-service.py` 和 `Dockerfile` 進行描述。

## 概述
Payment Service 是一個基於 Flask 框架的應用程式，用於處理付款相關的操作，並與 MongoDB 資料庫進行資料的存取。該服務提供 RESTful API，允許客戶端進行付款的新增、查詢、更新和刪除操作。

## 功能詳述

### 1. 環境設置
- **Python 版本**：3.9
- **依賴庫**：Flask、pymongo、python-dotenv
- **資料庫**：MongoDB

### 2. 主要路由

#### 2.1 獲取所有付款
- **路由**：`GET /payments`
- **描述**：返回所有付款資料的列表。
- **回應格式**：
  - 成功時返回 200 OK 和付款資料的 JSON 列表。
  - 失敗時返回 500 錯誤和錯誤訊息。

#### 2.2 獲取指定的一筆付款
- **路由**：`GET /payments/<payment_id>`
- **描述**：根據付款 ID 獲取特定的付款資料。
- **參數**：`payment_id` (string) - 付款的唯一識別碼。
- **回應格式**：
  - 成功時返回 200 OK 和付款資料的 JSON 物件。
  - 若未找到付款資料，返回 404 Not Found 和錯誤訊息。
  - 其他錯誤返回 500 錯誤和錯誤訊息。

#### 2.3 新增付款
- **路由**：`POST /payments`
- **描述**：新增一筆付款資料。
- **請求格式**：必須包含 `orderId` 和 `amount`。
- **回應格式**：
  - 成功時返回 201 Created 和新增的付款資料 JSON 物件。
  - 其他錯誤返回 500 錯誤和錯誤訊息。

#### 2.4 更新付款
- **路由**：`PUT /payments/<payment_id>`
- **描述**：更新指定付款的資料。
- **參數**：`payment_id` (string) - 付款的唯一識別碼。
- **請求格式**：必須包含更新後的 `orderId` 和 `amount`。
- **回應格式**：
  - 成功時返回 200 OK 和更新後的付款資料 JSON 物件。
  - 若未找到付款資料，返回 404 Not Found 和錯誤訊息。
  - 其他錯誤返回 500 錯誤和錯誤訊息。

#### 2.5 刪除付款
- **路由**：`DELETE /payments/<payment_id>`
- **描述**：刪除指定的付款資料。
- **參數**：`payment_id` (string) - 付款的唯一識別碼。
- **回應格式**：
  - 成功時返回 204 No Content，表示已成功刪除。
  - 若未找到付款資料，返回 404 Not Found 和錯誤訊息。
  - 其他錯誤返回 500 錯誤和錯誤訊息。

## 測試
測試文件 `test_payment-service.py` 使用 pytest 進行自動化測試，涵蓋以下功能：
- 獲取所有付款資料
- 根據 ID 獲取付款資料
- 新增付款資料
- 更新付款資料
- 刪除付款資料
- 測試錯誤處理（如查詢不存在的付款、格式錯誤的付款資料）

## Docker 部署
- **Dockerfile**：包含必要的指令來構建容器，開放端口 3004 以供外部訪問。
- **啟動命令**：`flask run --port=3004`，設定 Flask 應用在容器內運行。

## 總結
Payment Service 是一個簡單而高效的服務，能夠支持基本的付款處理需求，並可進一步擴展以符合更複雜的商業邏輯和安全需求。