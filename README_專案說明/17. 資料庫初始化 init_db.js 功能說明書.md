### 功能說明書：初始化資料庫

---

#### 檔案路徑
- `k8s-shopping-site_2_nodejs_mysql\init-db.js`

---

### 功能概述
此程式的主要功能是初始化一個名為 **ShoppingSiteDB** 的資料庫，並在其中建立多個與購物網站相關的資料表，包含使用者、商品、訂單、訂單細項及付款等資料表。此設置支援網站的基本交易流程，包括使用者下單、付款處理及查詢。

---

### 全域變數載入
1. **環境變數**：程式透過 `dotenv` 來載入 `.env` 檔案中的環境變數，用於設定資料庫的連線資訊。環境變數的路徑透過 `join(__dirname, './.env')` 指定。
2. **資料庫主機**：透過環境變數 `EC2_PRIVATE_IP` 來設定資料庫的 `host`。

---

### 資料庫初始化過程

1. **連線到 MySQL 資料庫**：
   - 使用 `mysql2` 的 `createConnection` 方法，連接至 MySQL 伺服器，並使用 `root` 使用者與密碼 `mysql`。

2. **建立資料庫**：
   - 檢查並建立資料庫 `ShoppingSiteDB`，以確保該資料庫存在。

3. **選擇資料庫**：
   - 使用 `USE` 指令切換到 `ShoppingSiteDB` 資料庫。

---

### 資料表結構

1. **`users` (使用者資料表)**：
   - 欄位：
     - `id`：自動遞增的主鍵。
     - `name`：使用者名稱，不可為空。

2. **`products` (商品資料表)**：
   - 欄位：
     - `id`：自動遞增的主鍵。
     - `name`：商品名稱，不可為空。
     - `price`：商品價格，使用小數點 (DECIMAL)。

3. **`orderDetails` (訂單細項資料表)**：
   - 欄位：
     - `id`：自動遞增的主鍵。
     - `productId`：對應 `products` 資料表的外鍵，標示此訂單細項中的商品。
     - `quantity`：商品數量。

4. **`orders` (訂單資料表)**：
   - 欄位：
     - `id`：自動遞增的主鍵。
     - `userId`：對應 `users` 資料表的外鍵，標示該訂單的使用者。
     - `orderTime`：訂單生成的時間戳，預設為當前時間。
     - `orderDetailId`：對應 `orderDetails` 資料表的外鍵，標示該訂單所包含的商品細項。

5. **`payments` (付款資料表)**：
   - 欄位：
     - `id`：自動遞增的主鍵。
     - `orderId`：對應 `orders` 資料表的外鍵，標示該付款對應的訂單。
     - `amount`：付款金額。

---

### 資料庫連線關閉
完成所有資料表的建立後，程式將會關閉 MySQL 的連線。