# 功能說明書：k8s-shopping-site Dockerfile

## 一、概述
此 `Dockerfile` 用於構建 `k8s-shopping-site` 專案的 Docker 映像，將應用程式包裝成可部署的容器。整個流程基於 Node.js，並使用 Dockerfile 定義了從設定環境、安裝依賴到啟動應用的步驟。最終構建出的映像能夠在容器環境中直接運行。

## 二、核心組件

### 1. 使用 Node.js 官方映像
```dockerfile
FROM node:14
```
- 使用 Node.js 的官方映像作為基礎映像，並指定 Node.js 版本為 `14`。這樣可以確保開發與生產環境的一致性。

### 2. 設定工作目錄
```dockerfile
WORKDIR /usr/src/app
```
- 設置容器內的工作目錄為 `/usr/src/app`，所有後續操作都會在此目錄下進行，以保持目錄結構的清晰與統一。

### 3. 複製依賴管理檔案
```dockerfile
COPY package*.json ./
```
- 將 `package.json` 和 `package-lock.json` 複製到容器的工作目錄中。這些檔案包含了應用程式的依賴資訊，Docker 在構建映像時會根據這些檔案來安裝所需的依賴。

### 4. 安裝應用程式依賴
```dockerfile
RUN npm install
```
- 執行 `npm install` 來安裝應用程式的所有依賴。這一步驟確保了應用程式在運行時具備所需的所有庫。

### 5. 複製應用程式檔案
```dockerfile
COPY . .
```
- 將整個專案目錄下的所有檔案複製到容器內的工作目錄中，以確保應用程式程式碼及相關資源都在映像內部。

### 6. 暴露應用程式的埠號
```dockerfile
EXPOSE 3000
```
- 將容器內的 `3000` 埠開放，使應用程式可以接收來自外部的 HTTP 請求。這個埠號需與應用程式的設定一致，這樣外部訪問時才會連接到正確的服務。

### 7. 啟動應用程式
```dockerfile
CMD ["node", "index.js"]
```
- 設定容器啟動時執行的指令為 `node index.js`，即運行應用程式的主檔案 `index.js`。透過這個指令，容器啟動後應用程式將自動執行。

## 三、使用方式

1. **構建映像**：
   - 在專案目錄下執行指令 `docker build -t k8s-shopping-site .`，將此 Dockerfile 構建成映像，並命名為 `k8s-shopping-site`。
2. **執行容器**：
   - 執行指令 `docker run -p 3000:3000 k8s-shopping-site`，將容器埠號 3000 映射至本機 3000 埠，啟動應用程式並可以透過 `http://localhost:3000` 訪問。

## 四、總結
此 `Dockerfile` 的設定能夠快速構建出符合 `k8s-shopping-site` 專案需求的映像，並適用於容器化部署環境。藉由標準化的映像構建流程，確保了應用程式的穩定性與一致性，使其能夠無縫地整合到 Kubernetes 等微服務架構中。